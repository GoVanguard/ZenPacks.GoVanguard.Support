{
    "servicePath": "/=Zenoss/=Collection/=localhost/=localhost",
    "serviceDefinition": {
        "Description": "Helps make the system consistent and supportable by users and GoVanguard.",
        "Actions": {
            "start": "su - zenoss -c '${ZENHOME:-/opt/zenoss}/bin/{{.Name}} start'",
            "status": "su - zenoss -c '${ZENHOME:-/opt/zenoss}/bin/{{.Name}} start'",
            "restart": "su - zenoss -c '${ZENHOME:-/opt/zenoss}/bin/{{.Name}} start'",
            "stop": "su - zenoss -c '${ZENHOME:-/opt/zenoss}/bin/{{.Name}} stop'"
        },
        "Command": "su - zenoss -c \"/usr/bin/nice -n 10 /opt/zenoss/bin/supportPoller run -c --duallog \"",
        "ConfigFiles": {
            "/opt/zenoss/etc/global.conf": {
                "Filename": "/opt/zenoss/etc/global.conf",
                "Owner": "zenoss:zenoss",
                "Permissions": "660",
                "Content": "# Generated by ServiceD - GoVanguard Support Helper and Poller\n{{range $k,$v:=contextFilter . \"global.conf.\"}}{{$k}} {{$v}}\n{{end}}"
            },
            "/opt/zenoss/etc/supportPoller.conf": {
                "FileName": "/opt/zenoss/etc/supportPoller.conf",
                "Owner": "zenoss:zenoss",
                "Permissions": "0664"
            }
        },
        "Endpoints": [
            {
                "Name": "mariadb",
                "Application": "zodb_.*",
                "Purpose": "import"
            },
            {
                "Name": "zenhub",
                "Application": "zodb_.*",
                "Purpose": "import"
            },
            {
                "Name": "zproxy",
                "Application": "zproxy",
                "PortNumber": 8080,
                "Protocol": "tcp",
                "Purpose": "import"
            },
            {
                "Name": "zenhub",
                "Purpose": "import",
                "Protocol": "tcp",
                "PortNumber": 8789,
                "Application": "localhost_zenhubPB",
                "ApplicationTemplate": "{{(parent (parent .)).Name}}_zenhubPB"
            },
            {
                "Name": "CollectorRedis",
                "Purpose": "import",
                "Protocol": "tcp",
                "PortNumber": 6379,
                "Application": "localhost_redis",
                "ApplicationTemplate": "{{(parent .).Name}}_redis"
            },
            {
                "Name": "rabbitmq",
                "Purpose": "import",
                "Application":"rabbitmq.*",
                "ApplicationTemplate":"rabbitmq.*"
            },
            {
                "Name": "controlplane_consumer",
                "Purpose": "import",
                "Protocol": "tcp",
                "PortNumber": 8444,
                "Application": "controlplane_consumer",
                "ApplicationTemplate": "controlplane_consumer"
            }
        ],
        "ImageID": "",
        "Instances": {
            "min": 1
        },
        "RAMCommitment": "512M",
        "CPUCommitment": 1,
        "Launch": "auto",
        "LogConfigs": [
            {
                "filters": [
                    "pythondaemon"
                ],
                "path": "/opt/zenoss/log/supportPoller.log",
                "type": "supportPoller"
            }
        ],
        "Name": "supportPoller",
        "Services": [],
        "Tags": [
            "daemon",
            "intergration",
            "GoVanguard"
        ],
        "Runs": {},
        "HealthChecks": {
            "poller_running": {
                "Script": "pgrep -f -u zenoss supportPoller > /dev/null",
                "Interval": 5.0
            },
            "mariadb_answering": {
                "Script": "/opt/zenoss/bin/healthchecks/mariadb_answering",
                "Interval": 10.0
            },
            "zenhub_answering": {
                 "Script": "/opt/zenoss/bin/healthchecks/zenhub_answering",
                 "Interval": 10,
                 "Timeout": 0
            },
            "redis_answering": {
                 "Script": "/opt/zenoss/bin/healthchecks/redis_answering",
                 "Interval": 5,
                 "Timeout": 0
            }
        },
        "Prereqs": [
            {
                "Name": "MariaDB connectivity",
                "Script": "su - zenoss -c '/opt/zenoss/bin/python /opt/zenoss/Products/ZenUtils/ZenDB.py --usedb zodb --execsql=\";\"'"
            }
        ],
        "Volumes": [
            {
                "Owner": "zenoss:zenoss",
                "ContainerPath": "/home/zenoss/.ssh",
                "Type": "",
                "ResourcePath": ".ssh",
                "Permission": "0755"
            },
            {
                "Owner": "zenoss:zenoss",
                "ResourcePath": "var-zenpacks",
                "ContainerPath": "/var/zenoss",
                "Permission": "0775"
            }
        ]
    }
}
